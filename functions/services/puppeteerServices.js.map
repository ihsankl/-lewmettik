{"version":3,"file":"puppeteerServices.js","names":["twitterPath","path","resolve","instagramPath","facebookPath","iPhone","puppeteer","devices","delay","time","Promise","setTimeout","GetProperty","element","property","getProperty","jsonValue","postToFacebook","page","user","process","env","FB_USER","pass","FB_PASS","photo","emulate","goto","screenshot","waitForSelector","isNotLoggedIn","$","saved","loggedIn","chooseAccEle","chooseAcc","type","all","click","waitForNavigation","waitUntil","timeout","notNowEle","notNow","evaluate","postField","Array","from","document","querySelectorAll","find","el","textContent","url","fileChooser","waitForFileChooser","uploadBtn","querySelector","accept","error","Boom","badRequest","getTwitImg","twitURL","tweetId","split","field","press","_client","send","behavior","downloadPath","allIcon","downloadIcon","fullPage","postToInstagram","IG_USER","IG_PASS","caption","findAllBtns","$$eval","elements","map","v","loginBtn","nextBtn","shareBtn"],"sources":["../../src/services/puppeteerServices.js"],"sourcesContent":["import Boom from '@hapi/boom';\nimport puppeteer from 'puppeteer'\nimport path from 'path';\n\nconst twitterPath = path.resolve('./twitter');\nconst instagramPath = path.resolve('./instagram');\nconst facebookPath = path.resolve('./facebook');\n\nconst iPhone = puppeteer.devices['iPhone SE'];\n\n/**\n * Delay code execution.\n * \n * @param {number} time\n * @returns {Promise}\n */\nfunction delay(time) {\n    return new Promise(resolve => setTimeout(resolve, time));\n}\n\n/**\n * Get the value of designated HTML Element.\n * \n * @param {Element} element\n * @param {Element} property\n * @returns {Promise}\n */\nasync function GetProperty(element, property) {\n    // eslint-disable-next-line no-return-await\n    return await (await element.getProperty(property)).jsonValue();\n}\n\nexport const postToFacebook = async (page, user = process.env.FB_USER, pass = process.env.FB_PASS, photo) => {\n\n    try {\n        await page.emulate(iPhone);\n        await page.goto(\"https://www.facebook.com/\");\n        await page.screenshot({ path: `${facebookPath}/1.png` })\n        await page.waitForSelector(\"#m_login_email\");\n        const isNotLoggedIn = await page.$(\"#m_login_email\")\n        let saved = false;\n        let loggedIn = true;\n        const chooseAccEle = await page.$(\"div > p\");\n        let chooseAcc = \"\";\n\n        if (chooseAccEle) {\n            chooseAcc = await GetProperty(chooseAccEle, \"textContent\");\n        }\n\n        if (chooseAcc === \"Choose your account\") saved = true;\n        if (isNotLoggedIn) {\n            loggedIn = false;\n            await page.type(\"#m_login_email\", user) // login field\n            await page.type(\"#m_login_password\", pass) // password field\n            await page.screenshot({ path: `${facebookPath}/2.png` })\n            // click Log In button\n            await Promise.all([page.click(\"button\"), page.waitForNavigation({\n                waitUntil: 'networkidle2',\n                timeout: 0\n            })])\n\n            // check if you logged in or not\n            await page.screenshot({ path: \"./facebook/3.png\" })\n\n            // check if facebook wanted to save your password. this script simply press Not Now\n            const notNowEle = await page.$(\"a > span\");\n            const notNow = await GetProperty(notNowEle, \"textContent\");\n\n            await page.screenshot({ path: facebookPath + \"/4.png\" })\n\n            if (notNow === \"Not Now\") {\n                await page.click(\"a\")\n                await delay(3000)\n            }\n            loggedIn = true;\n        }\n\n        if (saved) {\n            await page.screenshot({ path: facebookPath + \"/1a.png\" })\n            await Promise.all([\n                page.click(\"#root > div:nth-child(2) > div > div > div > div > div\"),\n                page.waitForNavigation()\n            ])\n            // passowrd\n            await page.type(\"input[type='password']\", user)\n            await page.screenshot({ path: facebookPath + \"/2a.png\" })\n            await Promise.all([\n                page.click(\"button[type='submit']\"),\n                page.waitForNavigation(),\n\n            ])\n            await page.click(\"a > span\");\n            await page.screenshot({ path: facebookPath + \"/3a.png\" })\n        }\n        if (loggedIn) {\n\n            // finding post field and clicking it\n            await page.evaluate(() => {\n                // eslint-disable-next-line no-undef\n                const postField = Array.from(document.querySelectorAll('div'))\n                    .find(el => el.textContent === `What's on your mind?`);\n\n                postField.click();\n            })\n            await page.screenshot({ path: facebookPath + \"/5.png\" })\n            await delay(1000)\n            // the url will changed. after that, you can upload anything\n            if (page.url() === \"https://m.facebook.com/?soft=composer\") {\n                await page.screenshot({ path: facebookPath + \"/6.png\" })\n                await page.click(\"#structured_composer_form > div > div > button:nth-child(1)\")\n                // const upload = await page.$(\"#photo_input\")\n\n                // // your file here\n                // await upload.uploadFile(`./twitter/${photo}`)\n                // start posting\n                const [fileChooser] = await Promise.all([\n                    page.waitForFileChooser(),\n                    page.evaluate(() => {\n                        // eslint-disable-next-line no-undef\n                        const uploadBtn = document.querySelector(\"#structured_composer_form > div > div > button:nth-child(1) > div\");\n\n                        uploadBtn.click();\n                    }), // some button that triggers file selection\n                ]);\n\n                // image to upload here\n                await fileChooser.accept([`${twitterPath}/${photo}`]);\n\n                await page.click(\"#composer-main-view-id > div > div > div > button\")\n                await delay(10000)\n            }\n            // last screenshot\n            await page.screenshot({ path: facebookPath + \"/7.png\" })\n        }\n    } catch (error) {\n        throw Boom.badRequest(error);\n    }\n};\n\nexport const getTwitImg = async (page, twitURL) => {\n    // https://twitter.com/txtdarigajelas/status/1520431822735257600\n    const tweetId = twitURL.split(\"/\")[5];\n    // https://kizie.co/tools/twitter-image\n\n    try {\n\n        await page.goto(`https://kizie.co/tools/twitter-image`);\n\n        // wait for the page to load\n        await page.waitForSelector(\"input\");\n\n        const field = await page.$(\"input\");\n\n        await field.type(twitURL)\n\n        // press enter after typing the url\n        await field.press(\"Enter\");\n\n        await delay(500);\n\n        await page._client.send('Page.setDownloadBehavior', {\n            behavior: 'allow',\n            downloadPath: twitterPath\n        });\n\n        await page.evaluate(() => {\n            // eslint-disable-next-line no-undef\n            const allIcon = Array.from(document.querySelectorAll(\"#__next > div:nth-child(1) > div > div > div > div > div > div > div > div > div > div\"))\n\n            // simulating a click on the post icon\n            allIcon[7].click();\n\n        });\n\n        await delay(500);\n\n        await page.evaluate(() => {\n            // eslint-disable-next-line no-undef\n            const downloadIcon = document.querySelector(\"#__next > div:nth-child(1) > div > div > div > div > div > div > button\")\n\n            // simulating a click on the download icon\n            downloadIcon.click();\n        })\n\n        // await page.waitForSelector\n\n        await delay(5000);\n        // screenshot\n        await page.screenshot({ path: twitterPath + '/kizie.png', fullPage: true });\n\n        return `kizie-${tweetId}.png`;\n    } catch (error) {\n        throw Boom.badRequest(error);\n    }\n};\n\nexport const postToInstagram = async (page, user = process.env.IG_USER, pass = process.env.IG_PASS, photo, caption = \"Sent from API\") => {\n\n    try {\n\n        await page.emulate(iPhone);\n        await page.goto(\"https://www.instagram.com/\");\n        await delay(3000);\n        await page.screenshot({ path: instagramPath + \"/1.png\" })\n        const findAllBtns = await page.$$eval(\"button\", (elements) => elements.map((v) => v.textContent))\n        const isNotLoggedIn = findAllBtns.find(v => v === \"Log In\")\n        let loggedIn = true;\n\n        if (isNotLoggedIn) {\n            loggedIn = false;\n\n            await page.screenshot({ path: instagramPath + \"/2.png\" })\n            await page.evaluate(() => {\n                // eslint-disable-next-line no-undef\n                const loginBtn = Array.from(document.querySelectorAll('button'))\n                    .find(el => el.textContent === `Log In`);\n\n                loginBtn.click();\n            })\n\n            // login with facebook credentials\n\n            // await Promise.all([page.click(\"button\"), page.waitForNavigation({\n            //         waitUntil: 'networkidle0'\n            // })])\n\n            // await page.type(\"#m_login_email\", \"YOUR USERNAME\") //login field\n            // await page.type(\"#m_login_password\", `YOUR PASSWORD`) //password field\n            // // click Log In button\n            // await Promise.all([page.click(\"button\"), page.waitForNavigation({\n            //         waitUntil: 'networkidle0',\n            // })])\n            // await delay(3000)\n            // await page.screenshot({ path: \"./instagram/login2.png\" })\n\n            // login directly with username and password\n            await page.type(\"input[name='username']\", user) // login field\n            await page.type(\"input[name='password']\", pass) // password field\n            await page.screenshot({ path: instagramPath + \"/3.png\" })\n            // click Log In button\n            await delay(500)\n            await page.screenshot({ path: instagramPath + \"/4.png\" })\n            await Promise.all([page.click(\"button[type='submit']\"), page.waitForNavigation({\n                waitUntil: 'networkidle2',\n                timeout: 0\n            })])\n            await page.click(\"button\")\n            await delay(3000)\n            await page.screenshot({ path: instagramPath + \"/5.png\" })\n\n            loggedIn = true;\n        }\n\n        if (loggedIn) {\n            // start posting\n            const [fileChooser] = await Promise.all([\n                page.waitForFileChooser(),\n                page.evaluate(() => {\n                    // eslint-disable-next-line no-undef\n                    const uploadBtn = Array.from(document.querySelectorAll(\"#react-root > section > nav > div > div > div > div > div > div\"));\n\n                    uploadBtn[2].click();\n                }), // some button that triggers file selection\n            ]);\n\n            // image to upload here\n            await fileChooser.accept([`${twitterPath}/${photo}`]);\n            await delay(500)\n            await page.screenshot({ path: instagramPath + \"/6.png\" })\n            if (page.url() === \"https://www.instagram.com/create/style/\") {\n                await page.screenshot({ path: instagramPath + \"/7.png\" })\n                await page.evaluate(() => {\n                    // eslint-disable-next-line no-undef\n                    const nextBtn = Array.from(document.querySelectorAll('button'))\n                        .find(el => el.textContent === `Next`);\n\n                    nextBtn.click();\n                })\n                await delay(500)\n            }\n            if (page.url() === \"https://www.instagram.com/create/details/\") {\n                // caption here\n                await page.screenshot({ path: instagramPath + \"/8.png\" })\n                await page.type(\"textarea\", caption)\n                await page.evaluate(() => {\n                    // eslint-disable-next-line no-undef\n                    const shareBtn = Array.from(document.querySelectorAll('button'))\n                        .find(el => el.textContent === `Share`);\n\n                    shareBtn.click();\n                })\n                await delay(10000)\n            }\n            await page.screenshot({ path: instagramPath + \"/9.png\" })\n        }\n\n    } catch (error) {\n        throw Boom.badRequest(error);\n    }\n};"],"mappings":"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"}